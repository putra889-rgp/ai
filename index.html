<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Owner & Member Panel</title>
  <style>
    body { font-family: Arial, sans-serif; background:#0d1117; color:#c9d1d9; padding:20px; }
    h1,h2 { color:#00ffcc; }
    .box { background:#161b22; padding:15px; border-radius:10px; margin:15px 0; }
    input,button { padding:10px; border-radius:8px; border:none; margin:5px 0; }
    button { background:#00ffcc; color:#111; cursor:pointer; font-weight:bold; }
    pre { background:#111; padding:10px; border-radius:8px; white-space:pre-wrap; }
  </style>
</head>
<body>
  <h1>ğŸ”‘ Login System</h1>
  
  <!-- Login -->
  <div class="box" id="loginBox">
    <h2>Login</h2>
    <input type="text" id="username" placeholder="Username"><br>
    <input type="password" id="password" placeholder="Password / Token"><br>
    <button onclick="login()">Login</button>
  </div>

  <!-- Owner Panel -->
  <div class="box" id="ownerPanel" style="display:none;">
    <h2>Owner Panel</h2>
    <button onclick="generateToken()">Generate Member Token</button>
    <pre id="tokenResult"></pre>

    <h3>Lookup NIK</h3>
    <input type="text" id="nikInputO" placeholder="NIK 16 digit">
    <button onclick="lookupNik('O')">Cari</button>
    <pre id="nikResultO"></pre>

    <h3>Cek Nomor HP</h3>
    <input type="text" id="noInputO" placeholder="Nomor HP">
    <button onclick="cekNomor('O')">Cek</button>
    <pre id="noResultO"></pre>

    <h3>Tracker Link Generator</h3>
    <button onclick="generateTracker()">Buat Link</button>
    <pre id="trackerLinkO"></pre>
  </div>

  <!-- Member Panel -->
  <div class="box" id="memberPanel" style="display:none;">
    <h2>Member Panel</h2>

    <h3>Lookup NIK</h3>
    <input type="text" id="nikInputM" placeholder="NIK 16 digit">
    <button onclick="lookupNik('M')">Cari</button>
    <pre id="nikResultM"></pre>

    <h3>Cek Nomor HP</h3>
    <input type="text" id="noInputM" placeholder="Nomor HP">
    <button onclick="cekNomor('M')">Cek</button>
    <pre id="noResultM"></pre>

    <h3>Tracker Link Generator</h3>
    <button onclick="generateTracker()">Buat Link</button>
    <pre id="trackerLinkM"></pre>
  </div>

  <!-- Tracker Page -->
  <div class="box" id="trackerPage" style="display:none;">
    <h2>ğŸ“¡ Tracker Log</h2>
    <pre id="trackerResult"></pre>
  </div>

  <script>
    const wilayah = {
      "12":"Sumatera Utara","31":"DKI Jakarta","32":"Jawa Barat","33":"Jawa Tengah",
      "34":"DI Yogyakarta","35":"Jawa Timur","36":"Banten","51":"Bali"
    };

    const provider = {
      "0811":"Telkomsel","0812":"Telkomsel","0813":"Telkomsel","0821":"Telkomsel","0822":"Telkomsel","0823":"Telkomsel",
      "0852":"Telkomsel","0853":"Telkomsel","0851":"Telkomsel",
      "0855":"Indosat","0856":"Indosat","0857":"Indosat","0858":"Indosat","0814":"Indosat","0815":"Indosat","0816":"Indosat",
      "0817":"XL","0818":"XL","0819":"XL","0859":"XL","0877":"XL","0878":"XL",
      "0831":"Axis","0832":"Axis","0833":"Axis","0838":"Axis",
      "0895":"Tri","0896":"Tri","0897":"Tri","0898":"Tri","0899":"Tri",
      "0881":"Smartfren","0882":"Smartfren","0883":"Smartfren","0884":"Smartfren","0885":"Smartfren","0886":"Smartfren","0887":"Smartfren","0888":"Smartfren","0889":"Smartfren"
    };

    let memberTokens = [];

    function login(){
      const user = document.getElementById("username").value;
      const pass = document.getElementById("password").value;

      if(user==="owner" && pass==="1234"){ // login owner
        document.getElementById("loginBox").style.display="none";
        document.getElementById("ownerPanel").style.display="block";
      } else if(memberTokens.includes(pass)){ // login member pakai token
        document.getElementById("loginBox").style.display="none";
        document.getElementById("memberPanel").style.display="block";
      } else {
        alert("Login gagal!");
      }
    }

    function generateToken(){
      let token = Math.random().toString(36).substring(2,10);
      memberTokens.push(token);
      document.getElementById("tokenResult").innerText = "Token Member: "+token;
    }

    function lookupNik(mode){
      const nik = document.getElementById("nikInput"+mode).value.trim();
      if (!/^\d{16}$/.test(nik)){ alert("NIK harus 16 digit!"); return; }

      let kodeProv = nik.substring(0,2);
      let provinsi = wilayah[kodeProv] || "Tidak diketahui";

      let tgl = parseInt(nik.substring(6,8),10);
      let bln = parseInt(nik.substring(8,10),10);
      let thn = parseInt(nik.substring(10,12),10);

      let gender="Laki-laki";
      if(tgl>40){ gender="Perempuan"; tgl-=40; }
      let tahunFull = thn<25 ? 2000+thn : 1900+thn;
      let tanggalLahir = `${tgl.toString().padStart(2,"0")}-${bln.toString().padStart(2,"0")}-${tahunFull}`;

      document.getElementById("nikResult"+mode).innerText =
        `NIK: ${nik}\nTanggal Lahir: ${tanggalLahir}\nJenis Kelamin: ${gender}\nProvinsi/Kota: ${provinsi}`;
    }

    function cekNomor(mode){
      const no = document.getElementById("noInput"+mode).value.trim();
      if(!/^\d{10,13}$/.test(no)){ alert("Nomor salah!"); return; }

      let prefix = no.substring(0,4);
      let kartu = provider[prefix] || "Tidak diketahui";
      let status = (parseInt(no.slice(-1))%2===0) ? "Aktif" : "Tidak Aktif";

      document.getElementById("noResult"+mode).innerText =
        `Nomor: ${no}\nJenis Kartu: ${kartu}\nStatus: ${status}`;
    }

    function generateTracker(){
      let url = window.location.href.split("?")[0]+"?tracker="+Math.random().toString(36).substring(2,8);
      document.getElementById("trackerLinkO").innerText = url;
      document.getElementById("trackerLinkM").innerText = url;
    }

    // === Jika halaman dibuka via tracker link ===
    window.onload = async function(){
      const params = new URLSearchParams(window.location.search);
      if(params.has("tracker")){
        document.body.innerHTML="";
        document.body.appendChild(document.getElementById("trackerPage"));
        document.getElementById("trackerPage").style.display="block";

        let log="";

        // IP & lokasi
        try{
          let ipdata = await fetch("https://ipapi.co/json/").then(r=>r.json());
          log += `ğŸŒ IP: ${ipdata.ip}\nISP: ${ipdata.org}\nLokasi: ${ipdata.city}, ${ipdata.region}, ${ipdata.country_name}\n\n`;
        }catch(e){ log+="ğŸŒ IP: gagal ambil\n\n"; }

        // Device info
        log += `ğŸ“± User Agent: ${navigator.userAgent}\n`;
        log += `ğŸ’» Platform: ${navigator.platform}\n`;
        log += `ğŸ–¥ï¸ Layar: ${screen.width}x${screen.height}\n`;
        log += `ğŸªŸ Window: ${window.innerWidth}x${window.innerHeight}\n`;
        log += `ğŸŒ Bahasa: ${navigator.language}\n`;
        log += `ğŸ• Timezone: ${Intl.DateTimeFormat().resolvedOptions().timeZone}\n`;
        log += `ğŸ”— Referer: ${document.referrer || "Direct"}\n\n`;

        // Battery
        if(navigator.getBattery){
          let b = await navigator.getBattery();
          log += `ğŸ”‹ Baterai: ${(b.level*100)}%\nâš¡ Charging: ${b.charging?"Ya":"Tidak"}\n`;
        }

        document.getElementById("trackerResult").innerText=log;
      }
    }
  </script>
</body>
  </html>
